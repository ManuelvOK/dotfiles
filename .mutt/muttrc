source ~/.mutt/account.ifsr

## editing
set editor  = 'vim + -c "set filetype=mail"'

set abort_noattach = ask-yes
set attach_keyword = "\\<(anhängen|angehängt|anhang|anhänge|hängt an|anhängig|attached|attachments?|anbei)\\>"


## sidebar
set meta_key = yes
bind index,pager B sidebar-toggle-visible
# Ctrl-n, Ctrl-p to select next, previous folder.
# Ctrl-o to open selected folder.
bind index,pager \CP sidebar-prev
bind index,pager \CN sidebar-next
bind index,pager \CO sidebar-open

bind index,pager <Pagedown> half-down
bind index,pager <Pageup> half-up


set imap_check_subscribed
set imap_keepalive = 300
set mail_check = 60

set ssl_force_tls = yes
set ssl_starttls = yes
set pgp_use_gpg_agent = yes

# GPG
source ~/.mutt/gpg.rc
set crypt_autosign
message-hook '!(~g|~G) ~b"^-----BEGIN\ PGP\ (SIGNED\ )?MESSAGE"' "exec check-traditional-pgp"

auto_view text/html
alternative_order text/enriched text/plain text/html text

bind index G imap-fetch-mail

set sort = threads
set sort_aux = reverse-last-date
set nomark_old

mailboxes =INBOX

# aliases
set alias_file=~/.mutt/aliases
set sort_alias= alias
set reverse_alias=yes
source $alias_file

# key bindings
bind  attach,browser,pager,index    g noop

macro index,pager                   gm '<sync-mailbox><enter-command>source ~/.mutt/account.manuel-thieme<enter><change-folder>!<enter>'
macro index,pager                   ö '<sync-mailbox><enter-command>source ~/.mutt/account.manuel-thieme<enter><change-folder>!<enter>'
macro index,pager                   gi '<sync-mailbox><enter-command>source ~/.mutt/account.ifsr<enter><change-folder>!<enter>'
macro index,pager                   gt '<sync-mailbox><enter-command>source ~/.mutt/account.tud<enter><change-folder>!<enter>'

bind generic                        l select-entry
macro index                         h '<change-folder>?'
bind index,pager                    H display-toggle-weed
bind pager                          h exit
bind pager                          j next-line
bind pager                          k previous-line
bind pager                          l view-attachments
bind index                          J next-thread
bind index                          K previous-thread
bind attach,browser,index           gg first-entry
bind attach,browser,index           G last-entry
bind index,pager                    d noop
bind index,pager                    dd delete-message
bind pager                          gg top
bind pager                          G bottom
bind pager                          r noop
bind pager                          rr reply
bind pager                          rg group-reply
bind pager                          rl list-reply
bind index                          \CR toggle-new
bind index                          "," limit
bind index                          "'" tag-prefix
bind index                          l display-message
bind attach,compose                 l view-attach
bind attach                         h exit
bind attach                         H display-toggle-weed

# to allow scrolling in mails
bind pager                          <Up> previous-line
bind pager                          <Down> next-line

# Appearance
source ~/.mutt/colors.rc
set pager_stop
set index_format='%4C %Z %<[y?%<[m?%<[d?%[%H:%M ]&%[%a %d]>&%[%b %d]>&%[%m/%y ]> %-15.15L (%?l?%4l&%4c?) %s'
